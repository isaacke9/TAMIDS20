FlightDelays <- dummy_columns(FlightDelays)
fit <- lm(data = FlightDelays, ARR_DELAY~EMPFULL + DISTANCE)
plot(fit)
summary(fit)
x <- c()
for (i in 1:10000){
  x<- c(x, dweibull(i/100, shape = 2,scale = 2))
}
plot(x, xlim = c(0,1000))
library(dplyr)
sample05<-sample_frac(FlightDelays, .05) 
sample05_dummy<- dummy_columns(sample05)

yearfit <- lm(data = FlightDelays05, FlightDelays05$LATE_ARR ~FlightDelays05$YEAR)
summary(yearfit)
boxplot(log(FlightDelays05$LATE_ARR)~FlightDelays05$YEAR)
anova(yearfit)
hist(log(FlightDelays05$LATE_ARR),breaks = 20)
plot(density(log(FlightDelays05$LATE_ARR)))
hist(FlightDelays05$LATE_ARR, breaks = 100, xlab = "Lateness", main = "Late arrivals")
max(FlightDelays05$LATE_ARR)
quantile(FlightDelays05$LATE_ARR, probs = c(.01, .99))
hist(FlightDelays05$LATE_ARR[FlightDelays05$LATE_ARR<188], breaks = 20, xlab = "Lateness", main = "Late arrivals")

UA <- filter(FlightDelays05_byCarrier, CARRIER =="UA")
hist(UA$LATE_ARR[UA$LATE_ARR<100], breaks = 30)
plot(density(UA$LATE_ARR[UA$LATE_ARR<100]))
exp <- dexp(0:100,rate = 1/24.2897)
plot(exp)
hist(UA$ARR_DELAY[UA$ARR_DELAY<100 & UA$ARR_DELAY>0], breaks = 30)
mean(UA$ARR_DELAY[UA$ARR_DELAY<100 & UA$ARR_DELAY>0])

UAplot <- ggplot(data = UA[UA$ARR_DELAY<100 & UA$ARR_DELAY>0,], aes(x = ))
lines(exp)
